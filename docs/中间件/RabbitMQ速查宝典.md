# RabbitMQ速查宝典

[toc]

## 简述
RabbitMQ是一个消息队列中间件。

为什么要使用MQ？
MQ为接口提供以下服务：
* 解耦：
    接口之间耦合严重的后果，就是当有新的系统需要接入时，需要对代码进行改造，开发联调效率低。
    假设系统A需要发送消息给B、C。现在要新增发送给系统D，若不使用MQ，则需要改接口，把处理好的数据也发送给D。
* 削峰（流量缓冲池）：
    有的接口会面临很高的并发，增加MQ机制，可以做到控制访问该接口的流量，避免因过大并发量造成不好的后果。
* 异步：
    将接口中调用的非关键操作异步化，可以有效提高接口的响应速度。
## 使用场景
* 消息中间件监控数据
* 异步数据传输
* 削峰填谷
* 任务调度
* 海量数据同步
* 分布式事务
* 日记管理
* 大数据分析
## FAQ
### 队列（Queue）和通道（Channel）的区别？

## 概念
* 生产者（Producer）：发送消息的应用。

* 消费者（Consumer）：接收消息的应用。

* 队列（Queue）：存储消息的缓存。

* 消息（Message）：由生产者通过RabbitMQ发送给消费者的信息。

* 连接（Connection）：连接RabbitMQ和应用服务器的TCP连接。

* 通道（Channel）：连接里的一个虚拟通道。当你通过消息队列发送或者接收消息时，这个操作都是通过通道进行的。

* 交换机（Exchange）：交换机负责从生产者那里接收消息，并根据交换类型分发到对应的消息列队里。要实现消息的接收，一个队列必须到绑定一个交换机。

* 绑定（Binding）：绑定是队列和交换机的一个关联连接。

* 路由键（Routing Key）：路由键是供交换机查看并根据键来决定如何分发消息到列队的一个键。路由键可以说是消息的目的地址。


## 队列模式
### 简单队列
一个队列，一个生产者，一个消费者。
### 工作队列
一个队列，一个生产者，多个消费者。
### 发布/订阅
一个交换机，一个生产者，多个消费者，多个队列（每个消费者都需要绑定到一个队列）。
流程：
1. 消费者将自己的队列绑定到交换机；
2. 生产者生成消息，并将消息发送至交换机；
3. 交换机将消息发送至绑定到自己身上的队列里；
4. 消费者从自己的队列里取出消息进行处理；
### 路由
与发布/订阅模式类似，一个交换机，一个生产者，多个消费者，多个队列（每个消费者都需要绑定到一个队列）。
但消息不会发送给所有队列，会根据一个叫路由键（key）的规则，将消息指定发送至某些队列里。
流程：
1. 消费者将自己的队列绑定到交换机，但绑定时还需要指定路由键（key），一个队列可指定多个路由键；
2. 生产者生成消息，并将消息发送至交换机，发送时指定路由键；
3. 交换机根据路由键，将消息发送至指定了该路由键的、绑定到自己身上的队列里；
4. 消费者从自己的队列里取出消息进行处理；

### 主题
与发布/订阅模式类似，一个交换机，一个生产者，多个消费者，多个队列（每个消费者都需要绑定到一个队列）。
但消息不会发送给所有队列，会根据通配符表达式（类似正则表达式），将消息指定发送至匹配该表达式的某些队列里。

## RabbitMQ的集群模式
### 主备模式
平时只有主节点提供读写，备节点不提供读写处理；只有当主节点宕机时，自动完成切换。
### 远程模式
### 镜像模式
### 多活模式


## 运维
### 安装RabbitMQ
### 参考资料

MQ篇(2-1)--最详细的RabbitMQ介绍 [https://blog.csdn.net/github_37130188/article/details/115289346](https://blog.csdn.net/github_37130188/article/details/115289346)

